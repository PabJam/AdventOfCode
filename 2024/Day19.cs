using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel.Design;
using System.Diagnostics.CodeAnalysis;
using System.IO;
using System.Linq;
using System.Numerics;
using System.Reflection.Metadata.Ecma335;
using System.Runtime.InteropServices;
using System.Text;
using System.Text.RegularExpressions;
using System.Threading.Tasks;
using System.Xml.Linq;
using Utils;

namespace _2024
{
    public static class Day19
    {
        public const string test_input_1 = "r, wr, b, g, bwu, rb, gb, br\r\n\r\nbrwrr\r\nbggr\r\ngbbr\r\nrrbgbr\r\nubwu\r\nbwurrg\r\nbrgr\r\nbbrgwb";
        public const string input_1 = "urbu, wrrbwrg, rgug, uwb, uwg, wubwgu, bgrwu, gubbuu, wrrub, rbr, bgrr, rrgrrur, rgu, ugrrru, bgu, uubbwrb, ugru, bwb, uwuu, urb, gwubw, ubu, wubwu, ubb, rugrgw, guu, rbwg, rug, brgugb, rwbrbwu, wu, bgrb, wgburg, uuguw, wbggr, guurrbbu, rggw, guwr, rwgrbrb, urbb, bwggwg, wgr, bbwurrw, bgubr, uuu, grru, rbbrbgbr, buwub, urr, gwrgb, wrwrgubu, rurrb, bwbuub, bgbub, wguu, gbrburw, rrb, rwuu, wgwgwubb, rruw, rurru, uuw, uu, ruu, wrwb, wbrgu, gwbuu, bbgw, grgggbr, bwgww, wbuw, wwb, wubguurw, wbuu, uwurgw, ugwbbbr, rbg, uburg, wrbug, gu, bwuugb, rbuwrbur, wguur, wwwbgu, ugbb, guwubw, uwbug, rwub, uwwgug, uur, wrg, ubgbb, uw, wru, uww, uubwg, wgrgw, bu, ugb, rur, bbw, wbgru, ruug, rrbb, ugu, urbgb, bbgu, bgbwgg, gbrwb, brub, wbu, rwbuur, bgggrw, rg, bgwr, wgwwuwu, gbg, gw, ruuw, wr, bww, uwr, ubgg, guwrw, rrr, wburguu, wrbbrru, rwwrg, rwg, bgg, wgw, www, gggbrrur, gbw, rgrr, bb, bwrwww, rb, rgbbu, bubu, ubwubw, w, wgbb, gwwb, r, gru, wugr, b, bubwu, ub, uugggg, ruwuub, buw, uuruuub, gb, grbgr, wwrg, wwg, grwr, wwr, rbrb, wwrrub, uuwbwgw, gggr, rgubr, guggu, rgwwg, bggr, wrruu, grub, gbbbbr, ubw, rbubw, bbbwwww, wuu, uwuuwww, wwu, gww, wbw, rwb, gbwg, bwr, gubgu, urubwrub, uuuw, rrw, wwruu, ggg, bwrrg, bugw, urw, gggwgw, uwgrgwrr, ugr, rgru, bgr, wbbwb, brg, rwbw, bwuu, brw, bbwbuwu, grur, wgbbwu, ru, rwu, rrgb, urbwrub, ubug, bwu, wbgbbg, uuubu, wbrgwrwg, gbgg, buu, uugu, rrbuu, brbg, brwuw, rbbbw, rbgr, buggrug, gbwr, gwr, wrrw, urug, bbbb, bbrgu, rrbwuru, ugggw, bbb, rrbrw, ubg, bwubgw, ugw, urwgr, uwwrgw, ugrbwu, rggwwwb, grubb, brb, rww, ububwr, brruburb, bbrgrur, uwwbgg, gbbrr, rggu, bbwug, wrb, wgugu, br, bbu, gbr, wbg, gbuw, wwug, bru, grwrur, bbr, bugwur, wrug, rrwbu, rw, uug, rgr, ugrubu, rbb, brgwug, rgwbg, rub, gbbg, bur, grg, bubgg, ugg, rbwu, rwr, bub, rrguw, gubb, bbgr, wbbburg, bgw, wb, wubw, ggwuub, bwg, bwbbrw, ggw, grubrg, rgw, uwwuw, uwbr, grr, rgb, bwrggwg, brbwur, uru, bguuubr, wwuwg, wuruwwbw, grrwwrgr, bwbu, rbuuuw, ubru, uub, uwbb, ruw, gwg, rbur, grw, gbgbu, uwbugw, wbb, gurb, ugbwgub, rgubrw, bbugu, urg, wrr, bw, wbubruw, wwwr, rrrb, ggbbbg, wug, rgruu, guwb, uuuggug, brrbrr, gr, buwbguwu, rgg, rrwg, wwgwrr, rrg, wurur, ggwbbrg, rrwgr, rruwu, buww, gbu, rrwuruub, brgr, wguwuu, urbrbg, rru, wgb, urubb, rbw, guru, buru, gur, ww, u, rwgw, gug, wwurwuw, rrbgrw, bwuwubu, bgrw, gguuugub, rbu, rubub, wrw, ggb, buwugrg, wgu, wwrbuu, bgurbg, gwu, bbwgb, uwwrrb, urugu, wugwrrgr, gwbbr, rgubg, bwrww, ug, wrwr, brur, bwur, gwgguw, wuwub, burww, gubwru, gub, bug, bwww, gwgugg, gruw, wgg, wrub, uwuwbgu, bwbw, gwuw, ubr, gbb, ubggru, wwubuw, rgrgru, wg, wub, wrgww, bwwub, gbur, bwgu, ur, rgwrrbw, wguuurb, rwrrg, ubrbburg, rgbggww, rgbgrur, brr, wrggbwr, ggr, guw, bgwb, gwrbwg, wrwbug, ubggu, bgrrb, wbr, wgub, gwbw, grb, rwbubwur, ubgw, gwbb, ugwwggrb, ggww, wugwur, rubwg, bgugw, wbubbu, rbbw, bgug, uggu, bgwrwrw, gwb, bgb, uwug, gurguug, wrrbw, gg\r\n\r\nwbrurgggrgbuwguwuwuwuwwwwgugwbwrwwuguwrrwubwuwrgwbugw\r\nuubrgurbrbgwgbbrruwrwrwgbrrgguuwrwbrgwgwgrgrgu\r\nbugwgurruguwwbgwuuggrrbrubgggbgrubbwuuuuuurrgwwurwguwugggg\r\nbrwugubrrbrgubrwubgwbrggrrrbwburgbugrwbrwubbg\r\ngbggwbrwugrbbrrbbrgbbbuguwwurrgguwrbubbbgbbgbbbg\r\nbgrwgugurwugurrwwgwbrruubuwuwggrubwrbbugggw\r\nwbrwrugwbugrubgwuggguwubbbrbrgrugwugggggrbbugwbgbbrbbg\r\nrwrbbrubwrbbbwurggwgurrwubgrwwwurwgburbbwgwu\r\nrubbbgggwuwggubuwgrrwurwgwbrwrguurugbgrgbbuburgbg\r\nbggubbgrgruubbbubrbburggguwgggrrguuwuubrugbgbgwuruur\r\nugwgugugubrbgwwwguugrwbwubburwwgwbrbrbbbwgbb\r\ngbgbbrbrwububuubgbwubgbbwrrwwggbugwrwbgrgwwggbwgggbrbuwwg\r\nugubgrbwbubrbugwguwrurguwwrgbrrurrbubuwrgburbwwgwu\r\ngubbbrwguugwwgbwbwwgbbgbuubbgrburrururgwbwr\r\ngwwbrrbwguurgrbgrwbubggurbbugrbwggrrwbgggbgbugbur\r\nwruwwurwuwgugurugwbuwbguwuwgugwguwuugggwubbrbu\r\ngrwbuwuwrgubwbubuwwbbwrwbwrggbgugbbugwuuugg\r\nburguuguuuuguwwggruwgbggbbbuuubwwguuwbgrrrrbuuu\r\nurbbgrwgbbbggurggbwuwgrubrwbgrbwugbwubwugbwrurw\r\ngggrbbgurruuguwwbbwguuugrwggbubwrubgbwwwgwbrgwwugrwgb\r\nrrrgrurwbwgrggrbrubbbbrgruubuuwgrgwrruwrbgb\r\nrgwrguggbgbwwbwwrggurgrgbuwubugwrugwbuggurbgwgwwrwgw\r\nwuwbuugggbrggbwgrugubrgwwrurwuuggubwwubuwwwwbubrrbwwbwubbg\r\nwuuuwgguuwgwgbrrbubbugggwbwgrwwgrgwubrgwbrwubwwwww\r\nubugbugrwbwwgbgugbruububggbgwwgggbggwuwuurruugbugrgrb\r\nwguruubgbbrgubguuwgbugurrbbwubruguwuggbwrguuguwrwuuwbbg\r\nrurwgbwbbrwrbugwwwbbuwwbbrrrbuuuugwrburgwbbbbwg\r\nwgbbgbwrwrrgubrwbgwwguwuwwugrbwwrubgrwburgrrbuwrgwrbrugbuw\r\nuggbrggbgwwgrbbrurwuuwgguwrbrgggwbrrggwuruurwrubgugguu\r\ngwbgrgruuubgwbrrrwwurgbbugbgbwgwgwubbwwurwrrurbubg\r\nwurrwuugbuggbrrrgwwugurgguurgugbbrgurgbwrwrbbg\r\nuwrggrgbrwbgrbgbbuwrubbububgwbrgbgubwbguuuwbr\r\nbbwurbgwuuwurwrwbrgrwrrbuubuggrrbwwgbwwurrrbugwwbubgubwr\r\nrgbrggrurgwbwbuubgurruwrgubuuwrwrrwuwrgbwugrbbguu\r\nwuwrgrbrugrgwugubggbubbrbbrgbbbrbbwgwbbg\r\nugwwbubwbruubwwgrwrburwrurubbwwrrugrbugugguwbuwwwgb\r\nrgwuuggbrwbgubbbbuwwuuruurbugbbugbbrrgbwbwgurrggu\r\ngugwwruurgwrrrwugbuwguubuwbwrrbugbggwwuwruww\r\nruugbggrubrbburgrbwwgugbgwbrguugrgggwrwwrggggubwuuugguwuubbg\r\nbuubbwgbggbrubgurgurrubbbrgwuruurbwgbwuubwb\r\nrbwguwubgrwruggwrwuubuggwurburbwbggubbwguuw\r\nbwuuwrrrwbburggubwggbuguwuwwwruwuwggwuuwubrrbu\r\nrrwwwubrrwrgburbrwbbbgwbgbwgugbrwwrrbbgubgguuuwguuurrg\r\nguurrbburuugggbwwwgbgbgugwubbgwbrbugbbbg\r\nrbbrruurbrgbrwrwruggwrgguuwuwwgrbgwwrbgrbbrbgbrrgggwwbgwwu\r\nwbbgbrrbrrgwbuwwwuwwuwruwbgwrrgbwuruuggbgbbbg\r\nrwbbrgurbwbwwbburwwguwgrrguuwgggwbgrrurbwubrruwgb\r\nrgrburrrgurwrgrbwurwwggwuuubwrugrguubuwugwwbbg\r\nurgwbwurugbwbgbbrwguggbugbbuwgguwgugrrwwgrrggrgugbrgbruwbbbg\r\nurwbrgggbururbwwrubgugwrgwbwbbwwbwrgrwgwrrggrbrurgggww\r\nrwguwwgwrbugrwruurbbbbwubwwbrwgwuwwrubwwbuubbwuuwuuwwbrg\r\ngrubugbuurgwbgwwgwbbuugurugwbbbwubgurrurgwubbg\r\ngrggguwubgbrwrrbgwuuwbgwrbgbuwwrrubbbwugrbubg\r\nbbbbwwurbrbbruubwuurwwwuuwbrbbbrgbwugrrgbbguwrubuuwbbg\r\nurruwrbrruburbugbwgruguuuuwbubuwrwgrbgrgrb\r\nurgrwwrggbgrwuubgbgwrwrurwubguruguwugubugwbbbrgg\r\nggbuwugrugbgguwurgrgwgbgwggubbrwrurrwuwwuurbbrgwwrwww\r\nurwgbugrbguuuwuwwbggbwruubgbbubgrgrwruubrwrugbbbbgwbg\r\ngrbwgwgwuwwrugwuuggwrrurrrbwubbgrrgguwburuuuwrubg\r\nuubugggrgurwrrbgrgubrwbubwgwgrrwwrgruurrbbbgbwgwubbg\r\nrgwrbgrbruuubburgrgguuwgurguuggbruurbbugwwrwbubbrbbg\r\nbgwubwuuwwubgwrrwggrubrrbgbrbgubrrbwugbguubwbwuuuwrbgrw\r\nrbwgwwugburbgbgruguguggrgrbbrgrbrrwugbuubuurwurrwrbrrbbbg\r\ngrbguwgrrrgbwugwrrgrgbbbrwrrrugugrgrrbrwrbrbrrwuubuuw\r\nbbbwugwbwrwuwrurwuuuwgbguuwurguwrgruwggurrwbgubgggbwb\r\nwgrbuwrburrgwbuurbrbrgbbuguubrrwugwbgwggwggrb\r\ngguwbbbubgrwrurrgbuburwwwrgbwwgbrwgbuwwrwbgrguugbgbgwrr\r\nrbgwbubgbwwbuubwrwbgrgbwrrgrwgwguwburbbbbbugwgbu\r\nwrruwrguwrwuwbrbgwguuurrugbwggrruugrbgugbbwurbruurgurbbg\r\ngugubbuubrguuuugbuwubwbwgubwwwwgwgwuwgrrwubu\r\nuruuuuggwuuwgwgwbrwwgguwgbuuwwrguwguwuwrwgwubbrrw\r\nbuuwrrgrwbrugrrwwbbguurbwwbgugbbguwrwuubrwuggw\r\nrrurgugbrbrbwbbubbggwwuwwwbrurbwugwbbgwwgg\r\nwgwuwguurbggrbwgrrrrggbuwggrwgbbgwubrgbrburbgwwurwu\r\nuwbwgwwbwurrurruugbggurbrgwwgrbuwurggwubuwr\r\nuuwwrwwwuuwwguwubgubbrurbbrgurwwgrrubbgubb\r\nrgwgguguguwwuwbbrgbuwguwggbrwgbugrwbugwbubgb\r\ngbbrwbwrrwgbwgwurugwuwbwbwwwrrrguuubggwrurwbwrbbrrwwrgwgb\r\nwuguwwwgbrbwubuuuguburugbbwgwgubwbugbgrrugwwwgbgbubgrw\r\nuugbwguubuubbrbrguwuwwgurbbwbgrgbugwgwgggrubbg\r\nwbrwurwwruwgwuuwruwgbrwrgrrbrwwgurbugbrgbbbbg\r\nruuwggwgwrrwgbrbwuuwuuburrgbbrguwugbrrubrwuu\r\nruruubgrrugggruruubbubugruruwbruwwgugwbgwuwuuwwbubbwbgwu\r\nbgwubguurgwuggwgwrrwgwuubrbgwbrwuurwwbrrurwgrgwgwrrrrwwru\r\nrrgbbgwwwbbwuuuruubgurwugbrrgwruwrurwbbwrg\r\ngwgbwwurwrugrrruwbbuwbugrbubgbggwuubwrurwugrwrugurbwgubbrb\r\nuwbgbggbwwuwwrwgwrrrbwbwwrbubwgwbbrrwguwgbuwuubwrburuwbw\r\nrwgbguruuuruwbgbwrbrgggrbrgburwbrugguwrrbbbg\r\nbugubbrubrbgwbbruuurbwgwgbbgbrbruugrbrbgrgrbbg\r\nguugrwwrwrgubuwbgbwrrgrbggrrgrubgruugbwrbrbwu\r\nwbuwubrggubgrggbubrugbrwwgwurrbgwgwwbuwgbbwurbuuububbggb\r\nugrugrubbwruburbbgwrburbbrbgbrbrggwwwuuuwwgurruubbrbbg\r\ngrbbrrubbbuwwurrurwwugggubrgbbwguwgbbgwbwwrr\r\ngbwbbwbugbggbwrgrwbbbbuwruuruuwrwbrrrgwuwubbugrgwwrruguwub\r\nruwgggwgwgubwwgrubgrwrguurrrubwbgbgruburwrgugruwuubwgwrbbg\r\nbwrgugwuubuwgugwgrgrugrgurwgwrgbuwbbrrbgrbwwrgbbugubbugbbbg\r\nrbrgrbuurgbwrrurwbrbrrgwgubwbbwuugrbwgbrgbrrw\r\ngwuuubuuggrwrbwruwbrwgwwruurbugwrgwwurrbrwwbbgwbbubrurbg\r\nggrrwgrrgburwrgurbbwwwrgrubrugrrwgbwbbbgbbwuuurubbgb\r\nrbugrwrubwuurwrrwwbwwwggwurwgrrrrruwggrgrurr\r\nubgwrbbbrrbwwgwwbbwbwwurruwgbbubwugurbuubbwuubrburbbg\r\nruuubrurgrgubuggrwgrbrbwbuuguwuburwuwuuggwgugrugbrgwurbww\r\ngwbrbrbrwubwbuururubrgubgrrgburrrbrbbrgugrwgwgwurb\r\ngguurgwgugrbwgbbbrwwbwgwwggubwbrrubrwbwrrbbg\r\nwugwrrgrwgguuurwwbgwururrwurwwbrrwgrwbbg\r\nbrrrwwwuwrbubbgrruwrwggbgwrgurgbrrwbwwwbwugwgr\r\nbgwrruwbrbubugwggrbbrggrrwwguububwbuwrgwbrgrrubbbbbgrgwuww\r\nrwbwbrbrguuwurwwrwgwururgwuwgbruburwbbwrbrwgbrwubwgwrgrrrw\r\nugubrbugbwggwbwuggugrwbggbbbwrubbrwugugwwburugbwbbg\r\nruwbbwrbwwuububwwuwurbrrwrbggbbrrbrwrwwgwbgbrgbwb\r\ngggbbwgwuuwrbuwwrburggbugurwbgbbgbruuwbbg\r\ngbrbgggbruurbgrwrrrbgwwruwugbgrwgwwrrurruwruubrurbrubgrwg\r\nbugwgbuwbbggrbuuggurrrrgrwwrrbbuwrrbugugwgwwuggrbgrggrur\r\nrrwgurwwgrbuurbgguwurrugggbrwwugwwubrrbbgwwburbrwu\r\nwwbgbwubwuwbbbburgugugubrbwgggbrbgrbbbggwubrgr\r\nrbbuwrbrbbwbwguruwrggurgurwrgubbwrrwrwruwwuuubw\r\nrbwbguuwwrgrwurbbuurgubuubuggrrwrggwrgwbgbuwrwu\r\nbwgbwbbubguwuugwrbrgbrguwrubuwguuwggwwburw\r\nrgruwruwrruwrurbrguuwrrbbbrrgwubbururgwgrur\r\nburwugruurwwwwrwbwrrrbubgrrrrubuuuwwbbgrbg\r\nbgbwrggwguurbbubwwwbuugwggubrgbubrwgwwwrwubbbg\r\nuwuruugwbbwbuwgrwgbbrbbgggggwuwggbwuubgbrrguw\r\nrbguuggrruwrrubggbuwrrwguwrubbbrbrrwgbgguuuuuuguuuug\r\nrwbwgurrbgurwrgbbrugwugugrbrwuuwrbgrgbgguwbgbubuuwrbg\r\nrrrrgwuwubwwuububwugruurbgburgbggburgbgwwuuuugwwrb\r\nwwgwubbwbrrurgrubbrubgrwrgbwrrruugwbrubugrrrbgwbbg\r\nuuguggrugguwgwrwbguwrgbrgugwwggrbwbubuwbwbwrrrwwuggruwwbwbbg\r\nbbrugbguwrgrurwwgbwwwrwgwbbwugbwurrrwbubuggrrbwwwwgb\r\nuugbbwburgbbruugwrubgugbwwugggggguugruuwbrbbg\r\nuwuurugrwubgggrgrugggrguuuugbgwwurrbuwrugbr\r\nwubrbgwgrwrwbwuggbwbgggrbuwwrbwggruugrggrrwubguurwbbg\r\ngbugrwgruuwwubgwbwbuguugggrggwwbgbubwgrubgbgrubgugur\r\nwwurwrurrrbugrbuwbwwuubrrbgwugbbuuwgrrbwwrbuwbbwwurbwrur\r\nrgurbugurgrwrrwbrrgwrgubwrbwbugwubrbwgubuuggrugwuguw\r\nbuwrgrrgrwgggbwgubgrrbgggbugwuugrrwbgubwugwruuruguw\r\nrwururuurggbugwrgrrugrbbuwwbwrwbrburgugwwrugbgwgwb\r\nggubrgbbrrgrgbuwuwurrgrrbbbwbrurrgbbbbgubrg\r\nwwwwgwrgubgrgubbrrwbbubbugurrwugbrgurrbggugbbbwgb\r\nrbrrrubuggrbrubwwuwbrwurgrwbwbgbbwrrbrrwgrbrggwbbugwbwwr\r\nrwugrbrbwwbugrbbuuugwurrgrrbuuwbgrrbrrgrrgwguwgrbbuuugugbbbg\r\nrgwrgrbububuubgbrrgwurwwrbrwwbbbbwgbgrbgwruwgwbgbrubrwgugw\r\nuggwubwggbwuwrggrrububgbwbrbwgrrgbwbwggwubwr\r\nbggugrbbuuurwuurubwgwwrburggwuubwuguwrgrrgrburgr\r\nrbrwwrrgrugwuwrugwwbburbuwwugrwgurwbwruuuurgwrubuubbbbbg\r\ngurgwbbubrrurwbubgrguwgbgwuuugggrgrggubugubwbbg\r\nuuubrbgwbrbbrgugrgbwubbrurgrugubbubwbrrwurgr\r\nbwbbrurgbbrwrbubgwgubugubuwbgruwuwgruwwwuuruu\r\nrwbgwuruubugggbrrurrrubwbwwwgrrwugbrgwgwbwgrggbrrr\r\nbwwwwgruwbuwrwbrrbbuburwwbggrgbwururrwggubwrugwwgbbugw\r\nubguggwugubgggbguuwgruuubgrrbgwwuurruwruuwrwbbwubbbbgbw\r\nuburwubgwugbgugwrwrbbwbrgbuwuuwrrwbrgbgrgbwwgwrbgbwwrbgwb\r\nrugurrbbgbrurrggbrbbgrugubwrubwgbuwuwbrrwgrrubbwbrgb\r\ngubwubbuwrbrgrrgwuwbwgggguggrgwgwugbrwruuwurgwrrbbg\r\nwggrwbgggrwrggrgrwrbbuurguggwrrubuuwggwbgbgbbggbr\r\nrwwwurwbbrbrubrruwuuuurrwwrurgrrbbwuruwbru\r\nuwuuggbgbuwubrrggrrbgwgrrbubbrrurbwguguwgbrubbg\r\nruugbbwggbgwurwwbgbrrbwburuuruggbgbuuwbbguuw\r\nrbrgbuugbwuggrruurrwbbbguguurururwwrwbrwrwuwwbbw\r\nwwgrruwbrbrrrbgrbbrgrwrwwbwruuugrwbuwrwbbrgbrwr\r\nwrwrguburwbuwbrgwurbwrgrwgbgburwgwgrrguugbbrugrbwgbgrrbbbg\r\nguuruugubguwggrbubwgrgwbbbugrrbbguguwuubbbbbg\r\nwwbrwurrubggrrbrbbuuwuwwbubgbwbgrbubrurugbrgbgbbbrubbr\r\nwwwrburruwbwguwwuwruwugwguuugbwgwrrgbuggwburgwggrbw\r\ngrgwrruuuubuurbururguwwrrwgwwburwrrbwgrwrgguurrb\r\nrwgurwuburbbwrwgrwrgurbwbrrwrbuwgwuurwuwguburwurburr\r\nbubwgbrrwwrbgbrwwurwuurwbuwuruurbrwwugugggguubuububruw\r\ngurbwgwuwuwgwwuwrrrrurbbugwgrgwrgugubgbbuug\r\nwurbrggwgrbguubgrggrwwgwurubburggrbgrwwbggbwrggbwurguu\r\nugwgwwwrurgbbgrrgrgbbrwgwwbubwbbbrwbgrurbbbuwrw\r\nwbrubrwbgbwrbbburbrbubgbggugrrrgubwrgbbbbg\r\nrbbwbwwwbbwrwuuugwurgrubuuwrbguwggwubrwburgwrgurugwuwrw\r\nwubbwbruuuburbguwwrugguurwbrrwbuwbgwwrwubuwgwwwggbuw\r\nwrbwrrgugubwbbrwrgbruwrrruuwrwgurugwbrbburwrgbguurw\r\nbbgwrbgrguburrguurrbubwbubwggbubwuguwwubrggwgbwuuguwurrbbbg\r\nubrbuuuuubuurrwwwggwuwrwububgrgwrrbbgwruwwbrwgbguwbwggw\r\nbburrrbrrbwgurwgwrwbbgrgrggbgrggruugwuwbbggbgbrru\r\nubbuubwwrwrbwrwbbggrwuuugugbwurgggbggrwgwuuurgbwgruwbggwbbg\r\nwubwwrwbuggwugbwwuugugrwbwuuwuwgbgwuwubbbg\r\nubwrwwrggrrwgurwruuwburbuggrbbgubrwwgrguwg\r\nwwbwrgwugbgwggrrbwugbwbrgbbrurbwgggrbwbrubwgr\r\nbwggwgbuuuurwurwgbrwguurwbbguwbrguwrgurubrwugrgugguuurgbu\r\nrggrggwuwwgwgbwrubggubrgwuwugguwuwrwbwgrru\r\nrburwbbuguwugwggruugwgwuuruurwwwbgwwbuwubbwbwwwgbrggu\r\nggbgbrbggugwbbgbwwruuguuubuugwrwrbbrggbubwgw\r\nugwrwbuwwgbgwuugguurburrgrggggbbwwwurugrurgwwbbugr\r\nrggwuubwruwgrrbbbbwgrgubrwbbgubrguburbgwwrrbgwbrbgubwwrrw\r\nugbugrurgwbuwrbrgubbuuuuwrrwrrbwuwrwrbbg\r\nubwuruuugrggubbrrwrrgwruubwrwbuwwwwuwrggurgurr\r\nbbgrwwwbwbwrbgurbrgwbrwwwgrrwrwugurgruwubug\r\nwrbruguugwggwubguggrbgwuwbwwuuuwwugggwwgrb\r\nuwrrwwubwrwrbgwgrruurwgbbbbbgrrgbrbgwgruwbruwwbrwbrr\r\nwrugbrubrgwgbgruwrbrrwgwrrbugrguwrwrwuwrrgu\r\nguwrubbgrgbrwurwbbbrgwubwrwwbuwbrugbbbrbguruwwg\r\nggrbwbuwrbrbwwrrwwwguwgbuuwwgrggwbuwwwugrgwwrrru\r\nrggbrubrugrrgwrrwuwbubbgggugwgbuububbwrgrgbbwrgw\r\nuuurrbbrrrwrbwwwwbwrbgwbwgbugrgrwuwburbbrwrbrwur\r\nwurguurbrrbgbuwuwruwgwurgugwbwbgbwurbggbwbruubbbbgbubwg\r\ngrbwgrrgrugrbbububwwruguubguwuwuururwggrbrrrwb\r\nggrbruurwggubrwruwbrrgwwwgurwuggugwbbgurbwrguburrgw\r\nbbwbrrwbubwururubwgrwbbgurwuwruruugrgrbwbbbg\r\nbguguurrrbuugburubgburwuuwbgwgwrbwbguurwrwggbrrwrbwbbg\r\ngrwwwuwrruuwbrbwbugbwgbuuggbgbbbgrbgggubgrwwuwuwwrubrgr\r\nbbrwwrwuruubrruugbwburwgubbbgwggrggwwuwrugbbbbbg\r\nwuuuguugbggrgrbwrubruguwurgrrrruwggwwuuwbbgububgbwbgwr\r\nrgurrbugurgubgbwbgggurwuuruubrubbuwbgrbgbbuubbg\r\ngrgwrugrbgwrgburgbbwugbwbrrbbwgrrbwgbuwrgugrwubg\r\nwbgwgwwwbwbubbbgurbrwrubbrwrbbbbrurguurgwuwggu\r\nrgurugwbruguuggrbbgwwurrbbgbwuubgrugwbbrwwrrbbg\r\nrurgrgrgbwubwrbrgbgwruuwurggbwggrruwbwuubbugg\r\nuuuggwgurgwgrgrwwgbuuwggurbwwwbrububugbgrubgrrrwubbg\r\nwwbubbwuwwgwwuwuubgwwbrwwrwbbbggrrwbuwuwrwgwgwubbg\r\nwugwruwwgrbubwuruguuwwwwgwuugwubgurgrrwrrwubuuuggrgu\r\nwubuwwubrgwuuwgbbgrwbgwrwbwrugbruggbugrbuwubbg\r\nggbbrubrgrwrgwuwwrrbgugguuwbwbwggrbbwbwbbwurbuwbugurrr\r\nwbbbrbwwubggrruuguwbrurgwbbrrrrrwbbrwurrgrugbrwurub\r\nwrubbbuwbwgguwbrrwrbbbruuruuugrrbwrrbruwbwbggrbggrgbbru\r\nurbbbwbrbubwgrrrwrgwrugrwrgggguwwbruggwrwrruurbgr\r\ngggbrgrrgbwbuwbguwuguwguugwwggbrrubbgrbg\r\nubrwgbbuwubrggrrbbruuuruuwurbubugbrbgguwbwwwuwbbg\r\nwuburburwrwbrrwbrugbwurbbwugrugbrbggwuurubbg\r\nbububugguuggbrgwgrbrgbbgwwruubggbggbrwubbgrbuwwru\r\nrwwwwrubuguwburubwubguurwbrrwwbgbgwbrugugwrgwrggu\r\nbbruugubugbrgururbbuwubbwbwbgrggrbruwwuwggwgbruggbgggg\r\nuuuuwbruugugwgwwwwugurwbguwbrwgguurgwgruwggugbrwrgr\r\nbbrrgburuwrwrrbbbuururrrwbgurwuuwubrguguuwuwgububugrbugu\r\nwbbggwbwggbgrrugurbgwrrburbuubrwruwugrbwwgwubbg\r\nwruugurwgbruburgbruuuugwguubggbwugrrggrurbbruugrg\r\nrubbrbubgbwwbbbgbrrubwrwwbrbuuwgbwubwwrwuggrrrbruuguwrwuub\r\nruwggruugruuuuburbugbuggbuurbbwrgguwrgbrbrbbg\r\nggwurbuurruurguubwugwrgwwbbugrwwgwggwwbburrgbggggruwbgr\r\nuuubrrrgwrbwgbgururuwwgwgbuwbuwggggbgbwbrgg\r\nburgubwburbwwgwgrwurrgbburubbrwguwrwgbrrgrbwbb\r\nwwwwuggrbbbwugwgwwwgrgwugrwbbrbuuwggbrwgwwrrwwwrwg\r\nurbrrgruwwrgbgwwbguburuuubbbrgrgubuuwuwrbu\r\ngwwwubrgwwuggugwwurwbgbwgbwubbuugguuugubbg\r\nwrwgwrrubbwbrwruguurbrwbbuuurrwbbbgbgwubwbbbg\r\nuurrgbwguugbwubbuwwbubwwbbgrwbggbwrgubbgruwr\r\nbrwuwwgrrwurruwgrwugrubugrrgbgwgwrwbgwrgbuuruuugg\r\nwrrrgrbwgrgrwwwwbggbgguggbbrugwwbuggburbguubwrbbrbgubbg\r\nubwwuwgbgguwggugwuuwbrggbwrrgbwgurbguwbrrbwbrrwugwwrubwur\r\nwwbgguburggbgbwgbrugrwgrubbrurbbbuwgbrgbgguwbwgw\r\nwbuwubwgwguwwwrrrbwbgwgugbubugguuwrbugurbubwbwburrbubbrurb\r\nbrbwrrgrrwurbgwggggwgrguruuburuuwuwrwwwgbruuuwbrrgwwgrrggw\r\nbbbwuurrbwgwugurbrbgguwgwrwbwuwrgwwgwrggurwubgugrr\r\nuburwguwuwwwwrugwbrbugrrubrgubwbrgwugurrrgwruwwbgrg\r\nwubgrrwbbbgwugwuwuwrgurugbrwgbgbrwgrbbgwgu\r\nbbwurgbwubbwgruugugbbrwuruwwbwburuurgggrbbubbg\r\nwburgbwbugrurwwuwwrrbwbbrugbubuwurgbgwgbwbgwbu\r\nbwwgrubgwrrrrbwrrrwbuuugugrwuggrgurrrggrbggwbrbgwbbg\r\nbgbggwbwwwwgbbrbwugwuuugrgbrurwgwbgugrrwbwbuwgbgbbub\r\nrbuwrgbrggbruwurwbrwbgbgrbuwrrwggugbrgbwubgwuggrugwwgurrww\r\nrggbwrubggurwrubgwugbwbuugwbrrggurggguuwwwbwwwrubrgrbrgu\r\nrgguwwrgrgwwurggbwbwbwgbgbggbgugbbbwrbrgbwbbg\r\nwugugrwbugbwbugrggbubuwwgwrbrwgwurwrbbbg\r\nbgbwwrwurgwuuuwwrbwrbugrwrwrwwgwwugwuuwwbwbugb\r\ngrrubwrwuggrwrgwbggbggwuubgubrrrrrbgggurrrwrw\r\nburruwwbbbbbguuguuwrrgwgwuwrrrrubgwrbrrwwbbbrgu\r\nrrrgrrwrrwbbwubrwuugggrrburrwwurgggrrwwrgrwwuu\r\ngrbwrbgwugrbugbrbbgbwbrrrrubbgbgbggbrrruwuwgwbugu\r\nuuwwggwwrgurwbwgbrwrbbgwubgbuuruwgwbwbwwrwbugrbg\r\nwbgbrurrguurrwruwuubbbrrubwurbbbbbugbbguurrrgwrgb\r\nrwbbwbwwuubrbruuuwbgguburgrburwbgwbgugrurwbbubrb\r\nubwgugruuuwwrwbgwgwbrggggrwgbbwrgwrrgrbwbbgrguurgb\r\nbggrrgurgbgubgbugwrggggwuurbruwruugrbbrwbbugugru\r\nurugugrubrgubwrrrbwugwururrwuwwrugwbgwwuubugw\r\nwubuwgwbwgrbuguwwubwrbuguwwbgwrrbrrwugwuubrrb\r\nuugbrruburbrrrrgrrgbrgbruwbgwwbrrurgguwuubbg\r\nubbwgwbgwugbwgwwrwbwbrrurguurguuurwgugrggbggwgw\r\nurrburbbrrwgrbgwggrugggbugurrburwugugubwwwrrwrbuggwgwuuruw\r\nwbrwuurggbgguruwrrgwrrrrbrrwrbgggrguwrwuurbbbuwgrurwu\r\nrrrgbbgrbwrwrwwbbuwrbguuwwurbwggwwbgwbwubrgwwgruggww\r\nbwgrwuurbwbwbrgwrwgwgwurugwrrrwuugrgrruwwgrru\r\nurwubrgwrgwgbbguwuggrwuburuwgggrrggubwggbg\r\ngbgguruubbrubwwruwwgwguuguuuuugwugrwgwuuwugrww\r\nrwrubugrguurggbgrugrgbuubbwwuuurbguggrwwgwggwuw\r\nguuuuwuwgrubggwuggrurgubwrbwruubgwbbugwwuggrgwrbug\r\nwbbuuguguruuwubuwgwwwbwubgwrbbrggwbbrrgbbbbuw\r\nrwruuubgburrguruugrwwruwrrubwbwwrgbrubwrgrbgwgwurbggwugur\r\nbrwurwuubwwrwwgwwrwgrruburuwggbwbggbuugwuu\r\nguwburubwruubwguurrbwurwgwuwbguuruuwwgwrwuuwbrrbugg\r\nurububwuwgrgrwwrwrwbbggrrrruugrrrugwbbbrubwbwggrguggurwrwbbg\r\nuruubbwurwrgrgrrgrbburrggwwbwwubwrgwgwugwwbburbgrrgbwb\r\nbbrrwgwrguubbuggwbbbwrrrurrguwrbggbbubrrggggwrwbrg\r\ngbbggwrrrgwrrrggubbbbuubwguuugubggrwrgrggbuwbbg\r\ngwrwbrgbubbbrugwgruuggguburbbgruububgrbbg\r\nrbgrruwguurwurgwugbuugrrggugbuwrubbrgwbuwggubuurgg\r\nwugwwgwgrbwbguruguguurwrggubrubruwrrugbbbwuubwrgwwgr\r\nbwbuubgbwwuwwggwgbburgugbbrgbuggrbubbgwurrrgur\r\nggbgrwgwbrgugwwwubbbubwrgbguuububuuburgrwgg\r\nburbwuwbrwbwrguwbwgrwruugggbrgwubbwbwrubbbbbrurrgbbrgrbwg\r\nbgrgugrwwggbbrgwgbbgbuuggguwwwwrrurbwwgrwrbbbbbbw\r\nrubrbgbuurgbrrwrbgrrwbbbwgbubguuuggrwgwrubgrrggguwbub\r\nbbwubwrgguugubwbbrwwgrrgubbgrgguggwbbbbgbruwgwwg\r\nbwburrwuruubggugwubgbrubwugwugurrgwgwgbbgbwrwuuubbwrwbbggbg\r\nrrwrwrggwbbrwuuwgbrwgruuubggwbbwwuuwwbbrrrbuwggugwu\r\nwrrrgubwwuubrbbburburwbbuwrggbgubgrbrbgrggwrrwgbbbg\r\ngrubwbwrrburrguwwuwbbwwwrgubgubwwwwrubgwggbuubggwburggrgrg\r\nrbgbbwrggrgrggbgrubrrrwubggrbggbbwrbwbrwwwguuuwwrbbuuwwbru\r\ngbubrgbrurrwuwgrrbgbgrbrgurrubuuruwwrbwuuurgrbrwbbg\r\nrrguuwwrbubbwggbgbbgwgwurrruwuuwuruuwwwrrwwubrbubuubg\r\nurrbubgwrgrgbrwburrggrbrwrugrrbggrbubrrrrbuurbbrrwugbbubbg\r\nwwugbruwbbwgbwwwruuwgrgwbuugurbwuuggrugrwgbubbbg\r\nrgruugbbgbruubgubgwwuugrggrbugrwbrrbubwwbggbrrgrrbbg\r\nubuwrwwgurbggwruuruwuwbbbggrugwuurwrrrwrgubbwbgugubub\r\nbrurbbbbbwuugbrrgrurgwuuggbruwuubwguwggwugwgwwbubuwgru\r\nbgwgrbrbgbuguwwrgbwwwrgurwuwbrgugbruwrrgbwwbgrw\r\nbrggbwwwrbrwwurbbwggwbuuugrubrbbgwbrgrwwwrwwwwrubbuuw\r\nwwwuggggbbbuuwgggurbgrrwurwggbubbwgbgbgwurb\r\nbwuubuuwrwrurgbbubbrwubbuuuugwbgbwuuugggrbruwbgurwr\r\nrurguruwrrbbruruwgurugwugwrrgbwggrbugwrubrbbg\r\nurbrgggwrbbwwgugrrbwrrbwugrugrbrgbruurrwurburwburggbwwww\r\nugwwbrrrrbwgggggguwbwrwbwrbububgwgbwbuurugbwuburguwr\r\nrbubbrwurbbbwwgbgwgrwbwuurrbggugbrgbuuwubguwgururrrbww\r\nbbbwgrbrurggwbgwgbgrgwwrburwuwbrwguwrbgwbruuwgwrgggu\r\nbwwwurwgwwbwgurwugrgbgrwwbrburbwrgggwrwurwbbrwrgrrwgww\r\nuuugugugguwbuuugbugrbgbbwwgugbbwwwrrugrbbwguubwbbgrubruub\r\nuuuggbgbugbruuuwbgwgurggbbgbwwwbwbwuugrurrugbrwbgw\r\nwbwrgggbrrguuwbuwgrwggbwuwgwbgurbuubugwbuw\r\nbggbuuwurwgbbubbwubwbugwrbugbggggrbwruwwgbrrwubwubugwwwbbg\r\nuuugwbuurgbwwgurwrrwrbrrrgrgrwrbbbuuuuuguwgwwbrbbg\r\nwbgurgurrrgwbwuwbuggwrgrwwuuburwuwwwgggruwwbugbbbg\r\ngbrrruubbwgbuubgbgwrugubbgrwbubgbwwurwruubwgw\r\nggbubrwwbbuugurrgrgwrwrbbuuwrguwruubrrggrggbwguwgu\r\nguwuwgggbubwwwbrwgbgrrbwuwrwruuubbguurwwwguuruwbgwwr\r\nubwugrurrguguwbuwggurbwwrggggbgrbuuuwwrurubwubgbgbwguguwg\r\ngwbgubuuurguwggrrguubuwuwbbgwubrbuwuuwrwbguurrbbuwrrwrb\r\nwrrrgwbgwwugrbuubgrrrruuwrgrwgrgrgggbrrurguugrubgwuwbgggwbbg\r\nrrrgwuwubwurwgwrubuurgruwbrwuguubbbwrwrbbggwbwwbww\r\nbwbbbggbwuwrgbbubrubrggrwurbwwbwuwuggrggrrbubg\r\ngruwguuwbrwururrwuuugbggbgugwuguugwrbbggurrwrbubb\r\nuggwuubrgugrgggrrwgrgrbgbrbgbwrwbggrwubwbbuu\r\nggrbbbgbwrgrwrurgrbgwbwbbrruruwgwrwbubgwwbwbwbuwwgburb\r\nuwwwrwubrwguruwwbwggbrgbrbuburbururgggugrwgrrwgguugwbwwbgg\r\ngrrbbwwrgbbbubrwbbbuuruugwwgwrrbggurrbggwwwwrgbr\r\nrgrubrbgguuugubwubrwuwuwgggurugrrubbrubwuurrgg\r\nwwwgwburwrbrwbwwwruurrbgbggubrbruuwbwwbgbrrbgwrww\r\nbubwbwrgrbuwrburwurgwgrwwbbwwgggbgggruuurggrbbg\r\nrbuuwbgwgwbwwwwbbggrwugugggwbgbbgwurwbuwwuwuur\r\ngurwrrubrgwgwgrgbrgrrbuwrbbuwggwbwrwbubwurguuwgwur\r\nbrgwrrrugrbgbbwruubwuguguugwbugbuwrgwrrwgurwwbrwwubwggwu\r\nuuurbrrgbubwrwgrbgwbrubuuugguwgwbrwbrruuugu\r\ngurrurwwuggruuwrgruwrbrwugrwwbbbwrgbugrrwbwwgbgburgbguwuw\r\nrruurbbbwbgbrrrrbgrgwuwwgrugggwbuwubbuugbwb\r\nurwuuuggugbbgrrgubbbrbururbggggrrubbbgwuuurbubbgbuwrurg\r\nbrwrugbwgbgbgwgwgwuwgggubrbbgbgurgubuwbbuu\r\nuugbgggwbubwrugurbwuwrbguuurgwwbwrrrrgwruburbrgruwbwuuguwbbg\r\nrwrbwubggrgggubwbwgwgbgrugbbwbugrgbrrgwrgrgbwuwruggugbggu\r\nwgrgbrwbguwuurwuwgbuwwrbwuwubwgwrggurrrrbrwwbwubgwg\r\nrrururggggrrrrrbbgubugwrwbgbuggbwugrwrwwgwbbbbrurbrgururgb\r\nugwwrubuwbuuwwbbrbbrwbwgurgwgugurubgbwgwruurbbwr\r\nwbgrgbbubbuwwgwwuwrbbbgwuubrbguurgbrbbgbggg\r\ngrwwuguwbbrggwbbugrbbubwwwwuuurwbgwwrrwwwrrbrwrggw\r\nggrgugbgbrwgwgubwbrwuruwurubrurugwrgruubbbwruurwbbbg\r\nrwbggbggbwgrgrrbuuwgbrrbwbubruubrgbwwburwbubrrgbgrgggubbrbbg\r\nwrwurrwwrggwwbwrbuurbwwgurbrgrbbugguwbugrrwu\r\nrgubggrubrggbbuuuwrwruurbrwugrwgguuburgurbuub\r\nbgguggbgwwgrbbrbgbrruggwuuwwugwuwbrubbgbwuuggbbwrwguggrb\r\nbgggubwbuuwgrgwrrwuruwwrugbugbwrrbgbrgwugugwwbbg\r\nbrruwubwugwuububwrbgbugurrruubggguwbubgrgwrgrrr\r\nwwwbubrrubbugurwrruwwruubbgwwgrwugwbuggubwr\r\nrwrggrrbugubguuggrwwrgwggruggrwugurwgubbg\r\nwwbbubwwrrrguurugurgugrwbugrgruburwurubwrububbggg\r\ngubrwbuwgrgbrbbubwbrrbrbbgrgbubrbwgubbbbg\r\nguwrgburrbrugbwbwbrgwrwgbuugbbggwbguwuwwwubbg\r\nubwwwburwbwwuurubgrgwrrgwuwbrrrwuruubrurww\r\nrgrgguubgrggwbrgrgbguuubbggrruwbrrruwruggrurwg\r\nuwwgbgwugurubbrbgwurbwubwurrurgbrbrbburgbrbwrguwuw\r\nrgwrgwwwrbruwrwbrgbbrbugbugugugururruwugburgbrwggruburbrb\r\ngbbubbwbububwurggwbugrbwgbwbrwwubuwbuubuugbwbbrw\r\nbwgggwrrguugbbgubuwwwubbgwrbrggrgggbrbwwww\r\nwguwbuwuwrbburrgbburbwuuwbwrrgrurwrwbrgwugubugbbwgwgru\r\nbbrbbwbbgwgrwbrwwgrwrrwrgwwwwgugruubbrbbbbg\r\nrgrwuwrgwrgwbrururbbbgggguwwubggwrrbrururbbb\r\nggwugugbwggurrwgubrwurugrwgwgrgbbrruuurwugrwr\r\nwrruugwwwrbgwbuurrubrwwubuugbgrbubgubbbg\r\nwgwwgbubwuuwrbggwrrrbrwrbwwguwbwwruuguugurwruug\r\nuuwggugubbgrguwgggwbbuwrgurgwubbrwbwgbgguurw\r\nbwwrrwruwrwbbbwwgggrbrwuuguwbwuwurggguwrubrwwbwuwbbg\r\nbbgwurwggbruwbgbbubbwgwgwbgwgwbuggrwwggguwrugwwrg\r\nuwbwgguwrgrbrgbruubgrbrurburugrugubbburuwuguwgugrwrbg\r\nwgrbrbrwubrgbubgbbbbbwrrgbgrrbgbrwggbgrwwubrbbrrurgruugu\r\nubwuurggrrrwbgubwwbgwguruurbwrwuruwwbwbgggbuwwwbgwug\r\nbugbbrugwbrggbburubwrubgbrurugwbbwgwggrbbbg\r\nrwruubgrurwrrbugrrubrrwuurwwbrubwrubbgwugrrwggbgurwb\r\ngwggugrbrbrgbbrugbuwbugwrgbrwugbbbwuwwgwgub\r\nrbuuwbbrbbbgwwuggrwwgrgurrwbbuugubwggbgbrwbbg\r\nbugrubwgbbbubrwguuruwwwgrruwbrgurubuuwwburrgubgg\r\nwwrbbuguguwwwuuurbwuuuuwuwwwurugugrbbgbbrwuugbwurbwurgb\r\nrgruugwbgbggbugggrrgggrwugbruuwwwrwggbwwwuwbwwgwwrggbubbg\r\nwuwrrgrbgwrggwwgrwbrurbwwrgrgrwuuuuubwururwggrrbrgubgwgug\r\nwruwbuwgrgbrwugburrrbugrguggwbgrrbwrgugwrbbwbrbrw\r\nuuwrgrbwrbwugwbbggwuwwuruurgwbbubbrrgggrgbrbwwrrurrgrguwbbg\r\nwbuwrbuguwwbbubwrwbgbgrbwwuwruwwuurrrwurgwrwguwgrwur\r\nugubbwrgwgbbururbuguubwbwugrbbggubgwuwgbuuggw\r\nuugwuuurrurgrugwgwbbwurggrbgugruurrruurgbuuw\r\ngugwbgbwbuwwbuwgrubbbgurgugwubguruwrwwrgrbgbbwbg\r\nwwurwurrrbwrgwurgwwuubrrgbbgbguuggbwuwbbbrggrbbg\r\nrubrgwwuwbwubwgwuurrrbgwugwwrwubwugwwggrbrrwggruurbuwubu\r\nrgurggrgruwrguwubwgrrwrrrubrrbuwwbwuwwwuwgb\r\nububwrwrubggwuggwrwuuwbwgbgwrguubruggbrgwbrrwug\r\n";
        public const string test_input_2 = test_input_1;
        public const string input_2 = input_1;

        public static long Part_1(string input)
        {
            string[] linesStr = input.Split("\r\n\r\n", StringSplitOptions.TrimEntries | StringSplitOptions.RemoveEmptyEntries);
            string[] available = linesStr[0].Split(",", StringSplitOptions.TrimEntries | StringSplitOptions.RemoveEmptyEntries);
            string[] desired = linesStr[1].Split("\r\n", StringSplitOptions.TrimEntries | StringSplitOptions.RemoveEmptyEntries);
            HashSet<string> impossible = new HashSet<string>();
            long sum = 0;
            for (int i = 0; i < desired.Length; i++)
            {
                if (Possible(desired[i], available, ref impossible)) { sum++; }
            }

            return sum;
        }

        public static long Part_2(string input)
        {
            string[] linesStr = input.Split("\r\n\r\n", StringSplitOptions.TrimEntries | StringSplitOptions.RemoveEmptyEntries);
            string[] available = linesStr[0].Split(",", StringSplitOptions.TrimEntries | StringSplitOptions.RemoveEmptyEntries);
            string[] desired = linesStr[1].Split("\r\n", StringSplitOptions.TrimEntries | StringSplitOptions.RemoveEmptyEntries);
            Dictionary<string, long> combinations = new Dictionary<string, long>();
            long sum = 0;
            for (int i = 0; i < desired.Length; i++)
            {
                sum += NumDesgins(desired[i], available, ref combinations);
            }
            return sum;
        }

        private static bool Possible(string desired, string[] available, ref HashSet<string> impossible) 
        {
            if (desired.Length == 0) { return true; }
            if (impossible.Contains(desired)) { return false; }
            for (int i = 0; i < available.Length; i++)
            {
                Match match = Regex.Match(desired, @"^(" + available[i] + @")(.*)");
                if (match.Success)
                {
                    if (Possible(match.Groups[2].Value, available, ref impossible)) { return true; }
                }
            }

            impossible.Add(desired);
            return false;
        }

        private static long NumDesgins(string desired, string[] available, ref Dictionary<string, long> knownCombinations)
        {
            long combinations = 0;
            if (desired.Length == 0) { return 1; }
            if (knownCombinations.TryGetValue(desired, out combinations)) { return combinations; }
            for (int i = 0; i < available.Length; i++)
            {
                Match match = Regex.Match(desired, @"^(" + available[i] + @")(.*)");
                if (match.Success)
                {
                    combinations += NumDesgins(match.Groups[2].Value, available, ref knownCombinations);
                }
            }

            knownCombinations.Add(desired, combinations);
            return combinations;
        }

    }
}
